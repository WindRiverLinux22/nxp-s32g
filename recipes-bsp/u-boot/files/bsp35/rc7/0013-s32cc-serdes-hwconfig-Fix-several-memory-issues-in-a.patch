From b5c4d6360cf8b179a5ecdfaaedf8f5d76ec476c8 Mon Sep 17 00:00:00 2001
From: Ionut Vicovan <Ionut.Vicovan@nxp.com>
Date: Fri, 4 Nov 2022 19:29:21 +0200
Subject: [PATCH 13/19] s32cc:serdes:hwconfig: Fix several memory issues in
 argument processing

Issue: ALB-9211

Upstream-Status: Pending 

Signed-off-by: Ionut Vicovan <Ionut.Vicovan@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 arch/arm/mach-s32/s32-cc/serdes_hwconfig.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/arch/arm/mach-s32/s32-cc/serdes_hwconfig.c b/arch/arm/mach-s32/s32-cc/serdes_hwconfig.c
index faf305e64b..5111e25052 100644
--- a/arch/arm/mach-s32/s32-cc/serdes_hwconfig.c
+++ b/arch/arm/mach-s32/s32-cc/serdes_hwconfig.c
@@ -45,7 +45,7 @@ bool s32_serdes_is_hwconfig_instance_enabled(int id)
 {
 	char serdes_name[SERDES_NAME_SIZE];
 	const char *arg;
-	size_t len;
+	size_t len = 0;
 
 	/*
 	 * The SerDes mode is set by using option `serdesx`, where
@@ -57,7 +57,7 @@ bool s32_serdes_is_hwconfig_instance_enabled(int id)
 		/* Backwards compatibility:
 		 * Initially the SerDes mode was set by using option `pciex`.
 		 */
-		sprintf(serdes_name, "pcie%d", id);
+		snprintf(serdes_name, SERDES_NAME_SIZE, "pcie%d", id);
 		arg = hwconfig_arg(serdes_name, &len);
 		if (!arg || !len)
 			return false;
@@ -91,7 +91,7 @@ char *s32_serdes_get_hwconfig_subarg(int id,
 		/* Backwards compatibility:
 		 * Initially the SerDes mode was set by using option `pciex`.
 		 */
-		sprintf(serdes_name, "pcie%d", id);
+		snprintf(serdes_name, SERDES_NAME_SIZE, "pcie%d", id);
 		debug("%s: testing hwconfig for '%s'\n", __func__,
 		      serdes_name);
 		subarg_str = (char *)hwconfig_subarg(serdes_name, subarg,
-- 
2.17.1


From f5a7aa01b381c2075a74ab55258b181e2384c94f Mon Sep 17 00:00:00 2001
From: Ghennadi Procopciuc <ghennadi.procopciuc@nxp.com>
Date: Wed, 22 Jun 2022 12:50:28 +0300
Subject: [PATCH 28/42] fdts: s32cc: Use nvmem cells instead of links to nvmem
 node

Issue: ALB-8357
Upstream-Status: Pending 

Signed-off-by: Ghennadi Procopciuc <ghennadi.procopciuc@nxp.com>
Signed-off-by: Zhantao Tang <zhantao.tang@windriver.com>
---
 fdts/s32cc.dtsi | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)

diff --git a/fdts/s32cc.dtsi b/fdts/s32cc.dtsi
index 50b74d720..ff1533814 100644
--- a/fdts/s32cc.dtsi
+++ b/fdts/s32cc.dtsi
@@ -861,7 +861,6 @@
 			#address-cells = <3>;
 			#size-cells = <2>;
 			serdes-handle = <&serdes0>;
-			nvmem-cells = <&siul2_0_nvram>;
 
 			ranges =
 				/* downstream I/O, 64KB and aligned naturally just
@@ -875,6 +874,9 @@
 			num-lanes = <2>;
 			link-speed = <3>;
 			bus-range = <0x0 0xff>;
+
+			nvmem-cell-names = "serdes_presence", "pcie_variant";
+			nvmem-cells = <&serdes_presence>, <&pcie_dev_id>;
 			status = "disabled";
 		};
 
@@ -915,7 +917,6 @@
 			#address-cells = <3>;
 			#size-cells = <2>;
 			serdes-handle = <&serdes1>;
-			nvmem-cells = <&siul2_0_nvram>;
 			ranges =
 				/* downstream I/O, 64KB and aligned naturally just
 				 * before the config space to minimize fragmentation
@@ -928,6 +929,10 @@
 			num-lanes = <1>;
 			link-speed = <3>;
 			bus-range = <0x0 0xff>;
+
+			nvmem-cell-names = "serdes_presence", "pcie_variant";
+			nvmem-cells = <&serdes_presence>, <&pcie_dev_id>;
+
 			status = "okay";
 		};
 
-- 
2.17.1

